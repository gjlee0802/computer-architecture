# ë©´ì ‘ ê¸°ì¶œ ì˜ˆì‹œ

## ê°œë… ì§ˆë¬¸
### Memory Hierarchy
#### 1. â“ìºì‹œê°€ í•„ìš”í•œ ì´ìœ ëŠ”? Cache hit ratio ì— ëŒ€í•´ ì„¤ëª…í•˜ì‹œì˜¤.
* ìºì‹œê°€ í•„ìš”í•œ ì´ìœ : 
~~~
ìºì‹œëŠ” ë°ì´í„° ì ‘ê·¼ ì†ë„ë¥¼ ë†’ì´ê³ , ì‹œìŠ¤í…œì˜ ì„±ëŠ¥ì„ ìµœì í™”í•˜ê¸° ìœ„í•´ ì‚¬ìš©
ì¦‰, ë¹ ë¥¸ ë©”ëª¨ë¦¬ì— ìì£¼ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ë¥¼ ì €ì¥í•´ì„œ ì„±ëŠ¥ì„ ë†’ì´ìëŠ” ì›ì¹™
~~~
* Cache hit ratioë€?:
~~~
Cache Hit Ratio(ìºì‹œ ì ì¤‘ë¥ )ëŠ” ìºì‹œì—ì„œ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì°¾ì„ í™•ë¥ ì„ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œë¡œ, 
ì „ì²´ ìš”ì²­ ì¤‘ ìºì‹œì—ì„œ ì„±ê³µì ìœ¼ë¡œ ì œê³µëœ ìš”ì²­ì˜ ë¹„ìœ¨ì„ ì˜ë¯¸í•¨

Cache Hit Ratio = Cache Hits / (Cache Hits + Cache Misses)
~~~

-----

#### 2. â“ë©”ëª¨ë¦¬ ì ‘ê·¼í•˜ëŠ”ë° x ì‚¬ì´í´ì´ ê±¸ë¦¬ê³  ìºì‹œì— ì ‘ê·¼í•˜ëŠ”ë° y ì‚¬ì´í´ì´ ê±¸ë¦¬ë©° ìºì‹œ hit rate ê°€ h %ì¼ ë•Œ effective access timeì€?
~~~
EAT (Effective Access Time)ì€ cacheë¥¼ í™œìš©í•œ ë©”ëª¨ë¦¬ ì ‘ê·¼ì˜ í‰ê·  ì†Œìš” ì‹œê°„ì„ ê³„ì‚°í•˜ëŠ” ê°’
~~~
~~~
Cache Hit rateì™€ Miss rateë¥¼ ê³ ë ¤í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì´ ê³„ì‚°í•¨:

EAT = (Hit Rate x Cache Access Time) + (Miss Rate x (Cache Access Time + Memory Access Time))-
    = Cache Access Time + Miss Rate x Memory Access Time
~~~
ğŸ¯ ì¦‰, `ìºì‹œ ì ‘ê·¼ ì‹œê°„ y`ì— `Cache Miss ë°œìƒ ì‹œ ì¶”ê°€ë¡œ ê±¸ë¦¬ëŠ” ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„`ì´ ë”í•´ì§€ëŠ” í˜•íƒœ!  

-----

#### 3. â“Page FaultëŠ” ì–¸ì œ ë°œìƒí•˜ëŠ”ê°€? Page Fault ë¹„ìœ¨ê³¼ Cache Miss ë¹„ìœ¨ ì¤‘ í° ê²ƒì€? ê·¸ ì´ìœ ëŠ”?
**Page FaultëŠ” ì–¸ì œ ë°œìƒí•˜ëŠ”ê°€?:**
~~~
ğŸ¯ Page FaultëŠ” Page Tableì—ì„œ í•´ë‹¹ í˜ì´ì§€ì˜ Valid Bitì´ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´, í•´ë‹¹ í˜ì´ì§€ê°€ ë¬¼ë¦¬ ë©”ëª¨ë¦¬ì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° ë°œìƒí•¨  
âœ… ì´ë•Œ ìš´ì˜ì²´ì œ(OS)ëŠ” ë””ìŠ¤í¬ì—ì„œ í•´ë‹¹ í˜ì´ì§€ë¥¼ ê°€ì ¸ì™€ ë©”ëª¨ë¦¬ì— ë¡œë“œí•˜ëŠ” ê³¼ì •(Page Swap-In)ì„ ìˆ˜í–‰í•¨  
~~~
**Page Fault ë¹„ìœ¨ê³¼ Cache Miss ë¹„ìœ¨ ì¤‘ í° ê²ƒì€? ê·¸ ì´ìœ ëŠ”?:**
~~~
ğŸ¯ ì¼ë°˜ì ìœ¼ë¡œ Cache Miss ë¹„ìœ¨ì´ Page Fault ë¹„ìœ¨ë³´ë‹¤ í›¨ì”¬ í¼  
âœ… ì´ìœ : ìºì‹œëŠ” ì‘ì€ ìš©ëŸ‰ì—ì„œ ë¹ ë¥´ê²Œ ë™ì‘í•˜ë©° ìì£¼ êµì²´ë˜ì§€ë§Œ, 
    í˜ì´ì§€ëŠ” ìš´ì˜ì²´ì œê°€ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ì—¬ ë””ìŠ¤í¬ ì ‘ê·¼ì„ ìµœì†Œí™”í•˜ê¸° ë•Œë¬¸  
~~~

-----

#### 4. â“Cache Missì˜ 3 ì¢…ë¥˜ (3C)ë¥¼ ë‚˜ì—´í•˜ê³  ê°ê°ì— ëŒ€í•´ Missë¥¼ ë‚®ì¶”ëŠ” ë°©ë²•ì„ ì„¤ëª…í•˜ì‹œì˜¤.
~~~
1ï¸âƒ£ Conflict Misses (ì¶©ëŒ ë¯¸ìŠ¤): 
    âœ… ì›ì¸: Set ë‚´ë¶€ì—ì„œì˜ Cache Entryë¼ë¦¬ ê²½ìŸìœ¼ë¡œ ë°œìƒ
    âœ… ê°ì†Œ ë°©ë²•: Fully Associative (Associative, Setì˜ ê°œìˆ˜ ì¦ê°€)

2ï¸âƒ£ Compulsory(aka. Cold Start) Misses (í•„ìˆ˜ ë¯¸ìŠ¤): 
    âœ… ì›ì¸: Blockì— ì²˜ìŒ ì ‘ê·¼í•  ë•ŒëŠ” ë¹„ì–´ìˆì–´, Missê°€ í•„ìˆ˜ì ìœ¼ë¡œ ë°œìƒ
    âœ… ê°ì†Œ ë°©ë²•: Blockì˜ í¬ê¸° ì¦ê°€

3ï¸âƒ£ Capacity Misses (ìš©ëŸ‰ ë¯¸ìŠ¤): 
    âœ… ì›ì¸: ìºì‹œ í¬ê¸°(ìš©ëŸ‰)ê°€ ë¶€ì¡±í•´ì„œ ê¸°ì¡´ì˜ Blockì´ ê°•ì œë¡œ ì œê±°ë¨
    âœ… ê°ì†Œ ë°©ë²•: ìºì‹œ í¬ê¸° ì¦ê°€
~~~

-----

#### 5. CacheëŠ” ë³´í¸ì ìœ¼ë¡œ í”„ë¡œê·¸ë¨ì˜ ë©”ëª¨ë¦¬ ì ‘ê·¼ íŒ¨í„´ì— ì¡´ì¬í•˜ëŠ” ë‘ ê°€ì§€ì˜ ì§€ì—­ì„± (Locality)ë¥¼ ì´ìš©í•œë‹¤. ë‘ ê°€ì§€ ì§€ì—­ì„±ì˜ ëª…ì¹­ê³¼ ê°ê° ì–´ë–¤ íŠ¹ì„±ì— ëŒ€í•œ ê²ƒì¸ì§€ ì„¤ëª…í•˜ì‹œì˜¤.
~~~
1ï¸âƒ£ Spatial Locality (ê³µê°„ì  ì§€ì—­ì„±): 
    ìµœê·¼ì— ì ‘ê·¼í•œ ì£¼ì†Œì™€ ì¸ì ‘í•œ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•  í™•ë¥ ì´ ë†’ë‹¤ëŠ” íŠ¹ì„±

2ï¸âƒ£ Temporal Locality (ì‹œê°„ì  ì§€ì—­ì„±): 
    ìµœê·¼ì— ì ‘ê·¼í•œ ë°ì´í„°ë¥¼ ê³§(ê°€ê¹Œìš´ ë¯¸ë˜ì—) ë‹¤ì‹œ ì ‘ê·¼í•  í™•ë¥ ì´ ë†’ë‹¤ëŠ” íŠ¹ì„±
~~~

-----

#### 6. Direct mapped cache, fully associative cache, set-associative cacheì˜ êµ¬ì¡°ë¥¼ ê°ê¸° ì„¤ëª…í•˜ê³ , (1) cache miss ratio, (2) cache latencyì˜ 2ê°€ì§€ ì¸¡ë©´ì—ì„œ ê°ê°ì˜ cache êµ¬ì¡°ê°€ ê°–ëŠ” ì¥ë‹¨ì ì„ ë…¼í•˜ì‹œì˜¤.
ğŸ¯ **ê° ìºì‹œì˜ êµ¬ì¡°**:  
* 1ï¸âƒ£ Direct Mapped Cache:
    ~~~
    êµ¬ì¡°: ê° blockì€ ì˜¤ì§ í•˜ë‚˜ì˜ cache lineì—ë§Œ ë§¤í•‘ë  ìˆ˜ ìˆìŒ
    Indexing: ì£¼ì†Œì˜ ì¼ë¶€ ë¹„íŠ¸ë¡œ cache line ê²°ì •, í•´ë‹¹ ìœ„ì¹˜ì˜ tagì™€ë§Œ ìˆ˜í–‰í•¨
    ~~~
* 2ï¸âƒ£ Fully Associative Cache:
    ~~~
    êµ¬ì¡°: blockì´ ì–´ëŠ ìœ„ì¹˜ì—ë“  ì €ì¥ ê°€ëŠ¥
    Indexing: Indexing ì—†ìŒ, ëª¨ë“  Tagë¥¼ ë¹„êµ
    ~~~
* 3ï¸âƒ£ Set Associative Cache:
    ~~~
    êµ¬ì¡°: í•œ blockì´ ì •í•´ì§„ ì—¬ëŸ¬ ê°œì˜ set ì¤‘ í•˜ë‚˜ì— ì €ì¥ ê°€ëŠ¥
    Indexing: Indexingìœ¼ë¡œ setì„ ì •í•˜ê³ , í•´ë‹¹ set ë‚´ë¶€ì—ì„œ Tag ë¹„êµ
    ~~~

ğŸ¯ **Cache Miss Ratio ê´€ì **: Fully Associative < Set-Associative < Direct Mapped  
| êµ¬ì¡°                 | ì¥ì                                      | ë‹¨ì                                                   |
|----------------------|------------------------------------------|--------------------------------------------------------|
| **Direct Mapped**    | ë‹¨ìˆœí•˜ê³  ë¹ ë¦„                            | **Conflict miss ë°œìƒë¥  ë†’ìŒ** (ê°™ì€ indexì— ì¶©ëŒ ë°œìƒ) |
| **Fully Associative**| **Conflict miss ì—†ìŒ â†’ ê°€ì¥ ë‚®ì€ miss ratio** | êµ¬í˜„ ë³µì¡, ë¹„ìš© í¼                                     |
| **Set-Associative**  | Conflict miss ì¤„ì–´ë“¦ (associativityì— ë”°ë¼) | associativityê°€ ë‚®ìœ¼ë©´ conflict miss ê°€ëŠ¥             |

ğŸ¯ **Cache Latency ê´€ì **: Direct Mapped < Set-Associative < Fully Associative
| êµ¬ì¡°                 | ì¥ì                                  | ë‹¨ì                                               |
|----------------------|--------------------------------------|---------------------------------------------------|
| **Direct Mapped**    | **ê°€ì¥ ë¹ ë¦„** (ë‹¨ì¼ ìœ„ì¹˜ë§Œ ë¹„êµ)     | ìœ ì—°ì„± ë‚®ìŒ                                       |
| **Fully Associative**| ìœ ì—°ì„± ë†’ìŒ                          | **ê°€ì¥ ëŠë¦¼** (ëª¨ë“  entry ë¹„êµ â†’ ë¹„êµê¸° í•„ìš”)     |
| **Set-Associative**  | íƒ€í˜‘ì  ì†ë„ (set ë‚´ì—ì„œë§Œ ë¹„êµ)      | associativity ë†’ì„ìˆ˜ë¡ latency ì¦ê°€               |

-----

### Virtual Memory
#### 1. â“ìºì‹œ ë©”ëª¨ë¦¬ì™€ ë©”ì¸ ë©”ëª¨ë¦¬ì˜ ì£¼ì†Œ ì§€ì • ë°©ì‹ì˜ ì°¨ì´ì ì´ ë¬´ì—‡ì¸ê°€?
~~~
ğŸ¯ ìºì‹œëŠ” CPUê°€ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•  ë•Œ Physical Addressë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì ‘ê·¼í•˜ë„ë¡ í•¨
    ë°˜ë©´, í”„ë¡œì„¸ìŠ¤ê°€ ì‚¬ìš©í•˜ëŠ” ë©”ì¸ ë©”ëª¨ë¦¬ëŠ” Virtual Addressë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì ‘ê·¼ 
    (OSê°€ Virtual Addressë¥¼ Physical Addressë¡œ ë§¤í•‘í•˜ì—¬ ë©”ì¸ë©”ëª¨ë¦¬ë¥¼ ê´€ë¦¬)
~~~

-----

#### 2. â“TLBë€ ë¬´ì—‡ì¸ê°€?
~~~
TLB: Virtual Addressë¥¼ Physical Addressë¡œ ë³€í™˜í•  ë•Œ ì‚¬ìš©í•˜ëŠ” Cache ì¥ì¹˜ë¡œ, ë§¤ë²ˆ ë©”ì¸ë©”ëª¨ë¦¬ì˜ Page Tableì„ íƒìƒ‰í•˜ì§€ ì•Šì•„ë„ ë˜ë„ë¡ í•˜ê¸° ìœ„í•´ ìµœê·¼ì— Translationì— ì‚¬ìš©í•œ ì£¼ì†Œ Mapping ì •ë³´ë¥¼ ë³´ê´€í•¨
~~~

## ğŸ’ª Cache Performance ê´€ë ¨ ì‹¬ì¸µ ë¬¸ì œ
### 1. â“Level 1 Cache(Primary Cache)ê°€ ì•„ë˜ì™€ ê°™ì€ Miss Rateë¡œ ë™ì‘í•œë‹¤ê³  í•˜ì. Miss rate = 0%ì¸ Perfect cacheê°€ ìˆë‹¤ê³  ê°€ì •í•  ë•Œ, ì•„ë˜ì˜ Cache ëŒ€ë¹„ ì„±ëŠ¥ í–¥ìƒ Factorì„ ê³„ì‚°í•˜ì‹œì˜¤. (SSU 17ë…„ë„ ê¸°ì¶œ)
**ì£¼ì–´ì§„ Cacheì˜ ë³€ìˆ˜:**
~~~
Instruction cache miss rate = 2%
Data cache miss rate = 4%
CPI = 1 without any memory stalls
Miss penalty = 100 cycles
Frequency of all loads and stores = 25%
~~~

**Actual CPI ê³„ì‚°:**
~~~
Base CPI = 1
I-Cache Miss Cycle = Instruction Cache Miss Rate x Miss Penalty 
    = 0.02 x 100 = 2 Cycle
D-Cache Miss Cycle = Data Cache Miss Rate x 0.25 x Miss Penalty 
    = 0.04 x 0.25 x 100 = 1 Cycle
Actual CPI = Base CPI + I-Cache Miss Cycle + D-Cache Miss Cycle 
    = 1 + 2 + 1 = 4 Cycle
~~~
ë”°ë¼ì„œ Perfect CacheëŠ” ìœ„ì˜ Cache ì„±ëŠ¥(Actual CPI)ì— ë¹„í•´ 4ë°°ì˜ ì„±ëŠ¥ í–¥ìƒì´ ìˆìŒ

-----

### 2. â“Multilevel Cache ì„±ëŠ¥ ë¹„êµì´ë‹¤. (SSU 17ë…„ë„ ê¸°ì¶œ)

**(a) ì£¼ì–´ì§„ Level-1 Cache(Primary Cache)ì˜ ë³€ìˆ˜:**
~~~
Clock rate = 4 GHz
CPI = 1.0 with a primary cache of 100% hit rate
Main memory access time = 100 ns (including miss handling)
Miss rate/instruction at the primary cache = 2 %
~~~

**(b) ì£¼ì–´ì§„ Level-2 Cacheì˜ ë³€ìˆ˜:**
~~~
Miss rate (to Main Memory) = 0.6 %
L2 cache access time = 5 ns
~~~

#### 2.1. â“Primary cache(L1 cache)ë§Œì„ ì‚¬ìš©í•  ê²½ìš° Total CPI(Effective CPI)ë¥¼ êµ¬í•˜ì‹œì˜¤. 
ğŸ¯ `Total CPI` = `Base CPI` + `Miss CPI` = `Base CPI` + (`Miss Rate/Instruction` x `Miss Penalty`)  
âœ… ì—¬ê¸°ì„œëŠ” Miss Penaltyë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒì´ ì¤‘ìš” Point!  
âœ… `L1 Cache Miss Penalty` = `Memory Access Time` / `Clock Cycle Time`  

âœ… **í’€ì´:**  
~~~
Base CPI = 1
Clock rate = 4GHzê°€ ì£¼ì–´ì§€ë©´, =>  1 Clock cycle ì†Œìš” ì‹œê°„ ê³„ì‚° ë– ì˜¬ë¦¬ê¸°
1 Clock cycle time = 1 / Clock rate = 1 / 4GHz = 0.25 ns
L1 cache Miss penalty = Memory Access Time / Clock Cycle Time = 100 ns / 0.25 ns = 400 Clock cycles
~~~
ğŸ¯ ë”°ë¼ì„œ Total CPI(Effective CPI)ëŠ” ì•„ë˜ì™€ ê°™ì´ ê³„ì‚°ë¨
~~~
Total CPI = 1 + (0.02 x 400) = 1 + 8 = 9 Clock cycles
~~~

#### 2.2. â“L2 cacheê¹Œì§€ ì‚¬ìš©í•  ê²½ìš° Total CPI(Effective CPI)ë¥¼ êµ¬í•˜ì‹œì˜¤.
ğŸ¯ `Total CPI` = `Base CPI` + `L1 Miss with L2 Hit CPI` + `L1 Miss with L2 Miss CPI`  
âœ… ì—¬ê¸°ì„œëŠ” L2 Cacheì—ì„œ Hitì¼ ë•Œì™€ Missì¼ ê²½ìš°ì˜ L1 Miss CPIë¥¼ ë‚˜ëˆ„ì–´ ìƒê°í•˜ëŠ” ê²ƒì´ ì¤‘ìš” Point!  
âœ… Primary Stalls: `L1 Miss with L2 Hit CPI` = `Miss rate at the primary cache` x `L1 Miss with L2 Hit Penalty`  
âœ… Secondary Stalls: `L1 Miss with L2 Miss CPI` = `L2 Miss rate (to Main Memory)` x `L1 Miss with L2 Miss Penalty`  

âœ… **í’€ì´:**  
~~~
1 Clock cycle time = 1 / Clock rate = 1 / 4GHz = 0.25 ns

(1). L1 Miss with L2 Hit Penalty ê³„ì‚°í•˜ê¸° (L2 Accessì— ëŒ€í•œ Penalty ê³„ì‚°)
L1 Miss with L2 Hit Penalty = L2 cache access time / Clock cycle time
    = 5 / 0.25 = 20 Clock cycles

(2). L1 Miss with L2 Miss Penalty ê³„ì‚°í•˜ê¸° (Main Memory Accessì— ëŒ€í•œ Penalty ê³„ì‚°)
L1 Miss with L2 Miss Penalty = Memory access time / Clock cycle time
    = 100 / 0.25 = 400 Clock cycles
~~~
ğŸ¯ ë”°ë¼ì„œ Total CPI(Effective CPI)ëŠ” ì•„ë˜ì™€ ê°™ì´ ê³„ì‚°ë¨  
~~~
Total CPI = Base CPI + Primary Stalls + Secondary Stalls
    = 1 + (2% x 20) + (0.6% x 400) = 3.8 Clock cycles
~~~

#### 2.3. â“L2 cacheê¹Œì§€ ì‚¬ìš©í•  ê²½ìš°, L1 cacheë§Œì„ ì‚¬ìš©í•  ê²½ìš° ëŒ€ë¹„ ì„±ëŠ¥ í–¥ìƒ Factorì„ ê³„ì‚°í•˜ì‹œì˜¤.
ğŸ¯ Primary cacheë§Œì„ ì‚¬ìš©í•  ê²½ìš°ì—ëŠ” Total CPIê°€ 9, L-2 cacheê¹Œì§€ ì‚¬ìš©í•  ê²½ìš° Total CPIê°€ 3.8ì´ì—ˆìœ¼ë¯€ë¡œ, 2.36ë°°ì˜ ì„±ëŠ¥ í–¥ìƒì„ ë³´ì„  
~~~
9 / 3.8 = 2.36
~~~

-----

### 3. â“TLB, Cache, Virtual Memoryë¥¼ í†µí•©í•˜ì—¬ ì‚¬ìš©í•œë‹¤ê³  í•˜ì. ê·¸ë¦¼ì€ CPUê°€ Virtual Addressë¡œ Memory Accessë¥¼ ìš”ì²­í–ˆì„ ê²½ìš° ì²˜ë¦¬ë˜ëŠ” ê²½ìš°ë“¤ì„ ë‚˜ëˆ„ì–´ ë³´ì—¬ì¤€ë‹¤. (SSU 19ë…„ë„ ê¸°ì¶œ)
![cache_tlb_virtualmem](../image_files/cache_tlb_virtualmem.jpg)  

#### 3.1. â“(E), (F), (I)ì˜ Box ì•ˆ ë‚´ìš©ì€ ê°ê° ë¬´ì—‡ì¸ê°€?
~~~
* (E): Lookup Page Table
* (F): Page Fault
* (I): Page Fault Exception => Page Fault Handler
~~~

#### 3.2. â“ì‹¤ì œ Physical Addressë¡œ Translationì´ ì´ë£¨ì–´ì§€ëŠ” êµ¬ê°„ë“¤ì€ ì–´ë””ì¸ê°€? (ì˜ˆì‹œ: Aì™€ B ì‚¬ì´ êµ¬ê°„)
ğŸ¯ Cacheì— ì ‘ê·¼í•˜ê²Œ ë˜ëŠ” êµ¬ê°„ì—ì„œ Virtual Address => Physical Addressì˜ Translationì´ ì´ë£¨ì–´ì§  
~~~
* Bì™€ C ì‚¬ì´ êµ¬ê°„
* Fì™€ G ì‚¬ì´ êµ¬ê°„
~~~
#### 3.3. â“TLB Access Time = 10ns, Cache Access Time = 20ns, Main Memory Access Time = 100nsë¼ê³  í•˜ì.

**3.3.1. â“ê·¸ë¦¼ í•˜ë‹¨ì˜ (0) ~ (3) ê°ê°ì— ëŒ€í•´ ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„ì„ ê³„ì‚°í•˜ì‹œì˜¤.**
~~~
* (0): 10 + 20 = 30 ns
* (1): 10 + 20 + 100 = 130 ns
* (2): 10 + 100 + 20 = 130 ns
* (3): 10 + 100 + 20 + 100 = 230 ns
~~~

**3.3.2. â“TLB Hit Rate = 99%, Cache Hit Rate = 80%ë¼ê³  í•˜ì. ê·¸ë¦¼ í•˜ë‹¨ì˜ (4)ëŠ” ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤ê³  ê°€ì •í•œë‹¤. CPUì˜ í‰ê·  ë©”ëª¨ë¦¬ ì ‘ê·¼ì‹œê°„ì„ ìœ„ 3.3.1. ë¬¸ì œì˜ ê²°ê³¼ë“¤ì„ ì´ìš©í•˜ì—¬ ê³„ì‚°í•˜ì‹œì˜¤. ë©”ëª¨ë¦¬ ì°¸ì¡° ì „ì²´ë¥¼ 1ë¡œ ê°„ì£¼í•  ë•Œ, (0) ~ (3) ê°ê°ì´ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨ì´ ì–¼ë§ˆì¸ì§€ë¥¼ ë¨¼ì € ê³„ì‚°í•˜ì‹œì˜¤.**

**(0) ~ (3) ê°ê°ì´ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨ ê³„ì‚°:** 
~~~
* (0): TLB Hit Rate x Cache Hit Rate = 0.99 x 0.8 = 0.79
* (1): TLB Hit Rate x Cache Miss Rate x 1 = 0.99 x 0.2 = 0.19
* (2): TLB Miss Rate x 1 x Cache Hit Rate = 0.01 x 0.8 = 0.008
* (3): TLB Miss Rate x 1 x Cache Miss Rate x 1 = 0.01 x 0.2 = 0.002
~~~

í‰ê·  ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„ ê³„ì‚°:
~~~
(0)ì´ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨ x (0)ì˜ ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„ + (1)ì´ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨ x (1)ì˜ ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„ + (2)ì´ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨ x (2)ì˜ ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„ + (3)ì´ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨ x (3)ì˜ ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„

= (0.79 x 30) + (0.19 x 130) + (0.008 x 130) + (0.002 x 230) = 51 ns
~~~

-----

### 4. â“ì•„ë˜ì˜ ì„¤ì • ì¤‘, ì–´ë–¤ ê²ƒì´ ë” ë‚®ì€ AMAT(Average Memory Access Time)ì„ ê°–ê³  ìˆëŠ”ê°€? ì´ìœ ë¥¼ í•¨ê»˜ ì„¤ëª…í•˜ì‹œì˜¤. (POSTECH 24-25 Second)
~~~
(1) A 32kB L1 cache, hit time of 1 cycle and miss time of 5 cycles, accessing a 256kB L2 cache. 
    The L1 hit rate is 70% and the L2 hit rate is 100%

(2) A 64kB L1 cache, hit time of 2 cycles and miss time of 4 cycles, accessing a 128kB L2 cache.
    The L1 hit rate is 90% and the L2 hit rate is 100%
~~~

âœ… **í’€ì´:**

**(1)ì˜ AMAT**ë¶€í„° ê³„ì‚°í•´ë³´ì.
~~~
L2 hit rateê°€ 100%ì´ë¯€ë¡œ, L2 missëŠ” ê³ ë ¤í•˜ì§€ ì•ŠìŒ
L1 hit rateê°€ 70%ì´ë¯€ë¡œ, L1 miss rateëŠ” 30%ì„

AMAT = L1 hit time + L1 miss rate x L1 miss pentalty
     = 1 + 0.3 x 5
     = 2.5 cycles
~~~

**(2)ì˜ AMAT**ë¥¼ ê³„ì‚°í•´ë³´ì.
~~~
L2 hit rateê°€ 100%ì´ë¯€ë¡œ, L2 miss rateëŠ” ê³ ë ¤í•˜ì§€ ì•ŠìŒ
L1 hit rateê°€ 90%ì´ë¯€ë¡œ, L1 miss rateëŠ” 10%ì„

AMAT = L1 hit time + L1 miss rate x L1 miss penalty
     = 2 + 0.1 x 4
     = 2.4 Cycles
~~~
  
ê²°ë¡ ì ìœ¼ë¡œ,  
~~~
ğŸ¯ (2)ì˜ (1)ë³´ë‹¤ ë” ë‚®ì€ AMATë¥¼ ê°–ê³  ìˆë‹¤.  
ì¶”ê°€ì ìœ¼ë¡œ, ìºì‹œ ìš©ëŸ‰ì€ AMAT ê³„ì‚°ì—ëŠ” ì§ì ‘ì ìœ¼ë¡œ ì˜í–¥ì„ ì£¼ì§€ ì•Šì§€ë§Œ,  
ìš©ëŸ‰ì´ ì»¤ì§€ë©´, ëŒ€ì²´ë¡œ Hit rateê°€ ì¦ê°€í•˜ê³  Miss rateê°€ ê°ì†Œí•˜ëŠ” ê²½í–¥ì´ ìˆë‹¤.  
~~~

-----

### 5. â“í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ ì‚¬ì´í´ì˜ 50%ë¥¼ ì—°ì‚°(Computation)ì—, ë‚˜ë¨¸ì§€ 50%ë¥¼ ë©”ëª¨ë¦¬ ê³„ì¸µ(Memory Hierarchy)ì„ í†µí•œ ë°ì´í„° I/Oì— ì‚¬ìš©í•œë‹¤ê³  ê°€ì •í•˜ì. ì‹œìŠ¤í…œì€ 2ë‹¨ê³„ ìºì‹œ ê³„ì¸µ êµ¬ì¡°(Two-level cache hierarchy)ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, L1 ìºì‹œëŠ” 4ì‚¬ì´í´ì˜ ì§€ì—° ì‹œê°„(latency)ê³¼ 10%ì˜ ë¯¸ìŠ¤ìœ¨(miss rate)ì„ ê°€ì§„ë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ, L2 ìºì‹œëŠ” 20ì‚¬ì´í´ì˜ ì§€ì—° ì‹œê°„ê³¼ 20%ì˜ ë¯¸ìŠ¤ìœ¨ì„ ê°€ì§€ë©°, DRAM ì ‘ê·¼ì€ í‰ê· ì ìœ¼ë¡œ 100ì‚¬ì´í´ì´ ì†Œìš”ëœë‹¤.  (POSTECH 22-23 Second)

#### 5.1. â“AMAT(Average Memory Access Time)ì€ ëª‡ ì‚¬ì´í´ì¸ê°€?
âœ… **AMAT ê³„ì‚° ê³µì‹(L2 missë¥¼ ê³ ë ¤í•œ ì¼ë°˜ì‹)**:  
~~~
AMAT = L1 hit time + L1 miss rate x (L2 hit time + L2 miss rate x Main Memory Access Time)
~~~

âœ… **ìœ„ì—ì„œ ì£¼ì–´ì§„ ë³€ìˆ˜ë“¤**ì„ ì •ë¦¬í•´ë³´ë©´,  
* L1 Cache
    * Hit time: 4 cycles
    * Miss rate: 10 %
* L2 Cache
    * Hit time: 20 cycles
    * Miss rate: 20 %
* Main memory
    * Access time: 100 cycles

ğŸ¯ AMATë¥¼ ê³„ì‚°í•´ë³´ë©´,  
~~~
AMAT = 4 + 0.1 x (20 + 0.2 x 100) = 8 cycles
~~~

âœ… "50% ì—°ì‚° + 50% ë©”ëª¨ë¦¬ I/O"ëŠ” AMAT ê³„ì‚° ìì²´ì—ëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠìŒ, ê·¸ëŸ¬ë‚˜ AMAT ê°œì„ ì´ ì „ì²´ ì„±ëŠ¥ í–¥ìƒì— ë¼ì¹˜ëŠ” ì˜í–¥ì„ ë¶„ì„í•˜ëŠ” ë° ê¼­ í•„ìš”í•¨

#### 5.2. â“ë™ì¼í•œ ë¹„ìš© ì˜ˆì‚° ë‚´ì—ì„œ ì „ì²´ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ ë‹¤ìŒ ì„¸ ê°€ì§€ í›„ë³´ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•  ìˆ˜ ìˆë‹¤. ê°€ì¥ ë¹ ë¥¸ ì‹œìŠ¤í…œì„ ë§Œë“¤ê¸° ìœ„í•´ ì–´ë–¤ ì˜µì…˜ì„ ì„ íƒí•´ì•¼ í•˜ëŠ”ê°€?
~~~
Option 1. ì—°ì‚°ì— ì†Œìš”ë˜ëŠ” ì‹¤í–‰ ì‚¬ì´í´ì„ 20% ì¤„ì¼ ìˆ˜ ìˆë„ë¡ ì»´í“¨íŒ… ì½”ì–´ë¥¼ ì—…ê·¸ë ˆì´ë“œí•œë‹¤.
Option 2. L1 ìºì‹œì— í”„ë¦¬í˜ì²˜(prefetcher)ë¥¼ ë„ì…í•˜ì—¬ L1 ë° L2 ìºì‹œì˜ ë¯¸ìŠ¤ìœ¨ì„ ì ˆë°˜ìœ¼ë¡œ ì¤„ì¸ë‹¤.
Option 3. í‰ê·  ì ‘ê·¼ ì§€ì—° ì‹œê°„ì´ 60ì‚¬ì´í´ë¡œ ë” ë¹ ë¥¸ DRAMì„ ë„ì…í•œë‹¤.
~~~

âœ… **ê¸°ì¤€ì„ : ê¸°ì¡´ ì‹œìŠ¤í…œì˜ ì „ì²´ ì‹¤í–‰ ì‹œê°„**:
* ì „ì²´ ì‹¤í–‰ ì‹œê°„ = ì—°ì‚° ì‹œê°„ + ë©”ëª¨ë¦¬ I/O ì‹œê°„
* ì—°ì‚°: 50%
* ë©”ëª¨ë¦¬ I/O: 50%
* AMAT: 8 cycles

ë”°ë¼ì„œ, **ì „ì²´ ì‹¤í–‰ ì‹œê°„ ê¸°ì¤€ì„** `100 cycles`ì´ë¼ê³  **ê°€ì •í•œë‹¤ë©´**,
* ì—°ì‚°: 100 x 0.5 = 50 cycles
* ë©”ëª¨ë¦¬: 100 x 0.5 x AMAT = 50 x 8 = 400 cycles
* ì—°ì‚° + ë©”ëª¨ë¦¬: 50 + 400 = 450 cycles

1ï¸âƒ£ Option 1ì— ëŒ€í•œ ì„±ëŠ¥ í–¥ìƒ ê³„ì‚°
* ì—°ì‚°: 50 x 0.8 = 40 cycles
* ë©”ëª¨ë¦¬: 400 cycles
* ì—°ì‚° + ë©”ëª¨ë¦¬: 40 + 400 = **440 cycles**

2ï¸âƒ£ Option 2ì— ëŒ€í•œ ì„±ëŠ¥ í–¥ìƒ ê³„ì‚°
* ìºì‹œ Miss rateê°€ ë‹¬ë¼ì¡Œìœ¼ë¯€ë¡œ AMATë¥¼ ë‹¤ì‹œ ê³„ì‚°í•˜ë©´,
    ~~~
    AMAT = 4 + 0.05 x (20 + 0.1 x 100) = 4 + 0.05 x 30 = 5.5 cycles
    ~~~
* ì—°ì‚°: 50 cycles
* ë©”ëª¨ë¦¬: 100 x 0.5 x AMAT = 50 x 5.5 = 275 cycles
* ì—°ì‚° + ë©”ëª¨ë¦¬: 50 + 275 = **325 cycles**

3ï¸âƒ£ Option 3ì— ëŒ€í•œ ì„±ëŠ¥ í–¥ìƒ ê³„ì‚°
* Memory Access Timeì´ ë‹¬ë¼ì¡Œìœ¼ë¯€ë¡œ AMATë¥¼ ë‹¤ì‹œ ê³„ì‚°í•˜ë©´,
    ~~~
    AMAT = 4 + 0.1 x (20 + 0.2 x 60) = 4 + 0.1 x 32 = 7.2 cycles
    ~~~
* ì—°ì‚°: 50 cycles
* ë©”ëª¨ë¦¬: 100 x 0.5 x AMAT = 50 x 7.2 = 360 cycles
* ì—°ì‚° + ë©”ëª¨ë¦¬: 50 + 360 = **410 cycles**

ğŸ¯ ê²°ë¡ ì ìœ¼ë¡œ, 
~~~
Option 2ì„ ì„ íƒí•´ì•¼ í•œë‹¤.
~~~

## ğŸ’ª Cache Associative ê´€ë ¨ ì‹¬ì¸µ ë¬¸ì œ
### 1. â“ê·¸ë¦¼ì€ 4 way set associative ë°©ì‹ cache memory êµ¬ì¡°ë¥¼ ë³´ì—¬ì¤€ë‹¤. ê° data í¬ê¸°ëŠ” 4 byteì´ë‹¤. (SSU 18ë…„ë„ ê¸°ì¶œ)
![4-way_set_associative_cache](../image_files/4-way_set_associative_cache.png)  
#### 1.1. â“ê·¸ë¦¼ì—ì„œ ë§¨ìœ„ Addressê°€ ì£¼ì–´ì¡Œì„ ë•Œ, cache hitì¸ì§€ íŒë‹¨í•˜ëŠ” ê³¼ì •, hitì¼ ê²½ìš° ìµœì¢… dataë¥¼ ì½ì–´ë‚´ëŠ” ê³¼ì •ì„ ì„¤ëª…í•˜ì‹œì˜¤.
1ï¸âƒ£ **Step 1. ì£¼ì†Œ ë¶„í•´** (Address Breakdown)
* ì£¼ì–´ì§„ 32-bit ì£¼ì†Œì—ì„œ:
    * Tag (22-bit): ìƒìœ„ 22ë¹„íŠ¸
    * Index (8-bit): ì¤‘ê°„ 8ë¹„íŠ¸ (256ê°œì˜ index)
    * Offset (2-bit): í•˜ìœ„ 2ë¹„íŠ¸ (4-byte ë°ì´í„°)

2ï¸âƒ£ **Step 2. Indexë¡œ Cache ì¡°íšŒ**
* Index í•„ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ Indexì˜ 4ê°œ(4-way) ìºì‹œ ë¸”ë¡ì„ ëª¨ë‘ ì¡°íšŒ
    * Index í•˜ë‚˜ë‹¹ 4ê°œì˜ ìºì‹œ ë¸”ë¡ì´ ì¡°íšŒë¨

3ï¸âƒ£ **Step 3. Tag ë¹„êµ ë° ìœ íš¨ì„± ì²´í¬**
* ê° wayì—ì„œ ì €ì¥ëœ Tagì™€ ì…ë ¥ Tagë¥¼ ë¹„êµí•˜ê³ , Valid Bitê°€ 1ì¸ì§€ í™•ì¸
* ì¼ì¹˜í•˜ëŠ” Tagê°€ ìˆê³ , ë™ì‹œì— Valid Bitê°€ 1ì´ë©´ Cache Hit

4ï¸âƒ£ **Step 4. Multiplexerì„ í†µí•œ ë°ì´í„° ì„ íƒ**
* Hitì´ ë°œìƒí•œ wayì˜ ë°ì´í„°ë¥¼ 4-to-1 ë©€í‹°í”Œë ‰ì„œë¥¼ ì‚¬ìš©í•˜ì—¬ ì„ íƒí•¨
* ì„ íƒëœ 4 byte ë°ì´í„°ë¥¼ ì¶œë ¥í•¨

5ï¸âƒ£ **Step 5. Hit ì‹ í˜¸ ì¶œë ¥**

#### 1.2. â“data ë¶€ë¶„ì˜ cache memoryì˜ ì´ í¬ê¸°ëŠ”? (byte ë‹¨ìœ„ë¡œ í‘œê¸°í•  ê²ƒ)
~~~
4 x 256 x 4 = 4096 bytes
~~~
#### 1.3. â“data ë¶€ë¶„ì˜ cache memoryì˜ ì´ í¬ê¸°ëŠ” ìœ„ì˜ 1.2.ì™€ ë™ì¼í•˜ê³ , 16 way set associative ë°©ì‹ìœ¼ë¡œ ë³€ê²½ë˜ì–´ ìš´ì˜í•œë‹¤ê³  í•˜ì. ë§¨ ìœ„ì— ì£¼ì–´ì§„ ì‹¤ì œ ë©”ëª¨ë¦¬ ì£¼ì†ŒëŠ” tag, index, block ë‚´ë¶€ offset(B) (ë˜ëŠ” block ë‚´ë¶€ offset(W) ë° Word ë‚´ë¶€ byte offset)ìœ¼ë¡œ ë‚˜ë‰œë‹¤. ê°ê° ëª‡ bitì¸ê°€?
1ï¸âƒ£ **Step 1. Indexì˜ í¬ê¸°(bits) ê³„ì‚°ì„ ìœ„í•´ Setì˜ ê°œìˆ˜ êµ¬í•˜ê¸°**:
~~~
16 way set associative ë°©ì‹ì€ í•œ Set ë‹¹ ë¸”ë¡ì˜ ê°œìˆ˜ê°€ 16ê°œë¼ëŠ” ì˜ë¯¸

Data ë¶€ë¶„ì˜ ì´ í¬ê¸° = 4096 bytes
Block(= Data 1ê°œ)ì˜ í¬ê¸° = 4 bytes

ë¸”ë¡(aka. Cache Entry)ì˜ ê°œìˆ˜ = 4096 / 4 = 1024 ê°œ

Setì˜ ê°œìˆ˜ = ë¸”ë¡(= Cache Entry) ê°œìˆ˜ / Way ìˆ˜
    = 1024 / 16 = 64ê°œ
~~~
2ï¸âƒ£ **Step 2. Tag, Index, Block ë‚´ Offsetì˜ í¬ê¸° ê³„ì‚°í•˜ê¸°**:
~~~
Index í¬ê¸° ê³„ì‚°: 
2^6 = 64 (= Setì˜ ê°œìˆ˜)ì´ë¯€ë¡œ, IndexëŠ” ëª¨ë“  Setì˜ ê°œìˆ˜ë¥¼ í¬í•¨í•  ìˆ˜ ìˆëŠ” 6 bitsë¡œ ì´ë£¨ì–´ì§

Byte ë‚´ Offset í¬ê¸° ê³„ì‚°: 
Byte Offsetì€ Blockì˜ í¬ê¸°ê°€ 4 bytesì´ë¯€ë¡œ 2 bitsë¡œ ì´ë£¨ì–´ì§

Tag í¬ê¸° ê³„ì‚°: 
TagëŠ” ì „ì²´ 32 bitsì—ì„œ Index, Bytes Offset ë¶€ë¶„ì„ ì œì™¸í•œ 24 bitsë¡œ ì´ë£¨ì–´ì§
~~~

#### 1.4. â“ê·¸ë¦¼ì€ CAM ì— í•´ë‹¹í•˜ëŠ”ê°€? CAMì˜ ì •ì˜ë„ í•¨ê»˜ ì„¤ëª…í•˜ì‹œì˜¤.
~~~
ê·¸ë¦¼ì€ CAMì— í•´ë‹¹í•œë‹¤.

CAMì´ë€?:
Content Addressable Memoryì˜ ì•½ì, ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œ ì£¼ì†Œë¥¼ ê°–ê³  íƒìƒ‰í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë©”ëª¨ë¦¬ì— ì €ì¥ëœ ë‚´ìš©ìœ¼ë¡œ íƒìƒ‰ (ë¹„íŠ¸ ë‹¨ìœ„ë¡œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³ , ì…ë ¥ëœ í‚¤ì™€ ë¹„êµí•˜ì—¬ ì¼ì¹˜í•˜ëŠ” ì£¼ì†Œë¥¼ ë°˜í™˜)

CAMì€ Associative Memoryì˜ í•œ í˜•íƒœì´ë©°, í•˜ë“œì›¨ì–´ì ìœ¼ë¡œ ë³‘ë ¬ ê²€ìƒ‰ì„ ìµœì í™”í•œ ë²„ì „ì´ë‹¤.
~~~

-----

### 2. â“64-byte ìºì‹œê°€ ì£¼ì–´ì¡Œë‹¤ê³  í•˜ì. 8-byte wordsì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ë ¤ê³  í•œë‹¤.
#### 2.1. â“ì–¼ë§Œí¼ì˜ wordë¥¼ ì €ì¥í•  ìˆ˜ ìˆëŠ”ê°€?
~~~
64 / 8 = 8 words
~~~

#### 2.2. â“ì´ëŸ¬í•œ wordsë¥¼ êµ¬ë¶„í•˜ê³  ì ‘ê·¼í•˜ê¸° ìœ„í•´ ì–¼ë§Œí¼ì˜ bitsê°€ í•„ìš”í•œê°€? 
ìºì‹œì— ì €ì¥ëœ ê° wordë¥¼ êµ¬ë¶„í•˜ê³  ì ‘ê·¼í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ë¯€ë¡œ, **Index bitsì— í•´ë‹¹**
~~~
2^3 = 8 ì´ë¯€ë¡œ, 
wordsì˜ ì£¼ì†Œë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•´ 3 bitsê°€ í•„ìš”í•¨
~~~

#### 2.3. â“ê° word ë‚´ byteì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ ì–¼ë§Œí¼ì˜ bitsê°€ í•„ìš”í•œê°€?
word ë‚´ì—ì„œ íŠ¹ì • byteë¥¼ ì„ íƒí•˜ê¸° ìœ„í•œ ê²ƒì´ë¯€ë¡œ **Offset bitsì— í•´ë‹¹**
~~~
ê° wordëŠ” 8 bytesë¥¼ ê°–ê¸° ë•Œë¬¸ì—,
word ë‚´ ê° byteì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ 3 bitsê°€ ë” í•„ìš”í•¨
~~~

-----

### 3. â“Consider an 8-way set-associative cache with 2MiB (data) capacity in a single-core 32-bit architecture CPU. The cache consists of 2048 sets. (POSTECH 22-23 First)

#### 3.1. â“How many bits from memory address are used for tag, set index, and block offset, respectively?
âœ… **block offset:**
~~~
8-way set-ssociativeëŠ” í•œ set ë‹¹ blockì˜ ê°œìˆ˜ê°€ 8ê°œë¼ëŠ” ì˜ë¯¸
data ë¶€ë¶„ì˜ ì´ í¬ê¸°ëŠ” 2 Mebibytes ì´ë¯€ë¡œ (2 x 1024 x 1024) bytes
block 1ê°œì˜ í¬ê¸°('block size')ë¥¼ ëª¨ë¦„
2 x 1024 x 1024 = 2048 x 8 x block size
block size = 2^7 = 128 bytes

block offsetì€ block 1ê°œ í¬ê¸°ì¸ 128 bytesë¥¼ í‘œí˜„í•  ìˆ˜ ìˆì–´ì•¼ í•¨
=> block offsetì€ 7 ë¹„íŠ¸
~~~

âœ… **set index:**
~~~
2048 sets, ì¦‰ 2^11ì˜ index ê°œìˆ˜ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆì–´ì•¼ í•¨
=> set indexëŠ” 11 ë¹„íŠ¸
~~~

âœ… **tag:**
~~~
tagë¥¼ ìœ„í•´ì„œëŠ” 32-bitì—ì„œ set indexì™€ block offsetì— ì‚¬ìš©ë˜ëŠ” ë¹„íŠ¸ë¥¼ ì œì™¸í•œë§Œí¼ ì‚¬ìš©ë¨ (32 - 11 - 7)
=> tagëŠ” 14 ë¹„íŠ¸
~~~

ğŸ¯ **ê²°ë¡ ì ìœ¼ë¡œ ì •ë¦¬í•˜ìë©´,**
~~~
tag: 14 bits | set index: 11 bits | block offset: 7 bits
~~~

ğŸ¯ **í’€ì´ í•µì‹¬:**
* block offset: í•˜ë‚˜ì˜ block ë‚´ offset => ë¸”ë¡ì˜ í¬ê¸°ë¥¼ ë‹¤ í‘œí˜„í•  ìˆ˜ ìˆëŠ”ê°€?
* set index: ì´ setì˜ ê°œìˆ˜ë¥¼ ë‹¤ í‘œí˜„í•  ìˆ˜ ìˆëŠ”ê°€?
* tag: ì „ì²´ ë¹„íŠ¸(32-bit)ì—ì„œ block offsetê³¼ set indexë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ë¹„íŠ¸

#### 3.2. â“Assuming a write-back cache, what is the cacheâ€™s storage overhead for metadata (e.g., tags, etc.) in KiB?
âœ… **ë¬¸ì œ ì˜ë„:**
~~~
ë©”íƒ€ë°ì´í„°ì˜ ì˜¤ë²„í—¤ë“œë¥¼ êµ¬í•˜ëŠ” ë¬¸ì œì„ (=> ì „ì²´ ë©”íƒ€ë°ì´í„° í¬ê¸° êµ¬í•˜ê¸°)
Write-back cacheì´ê¸° ë•Œë¬¸ì— ë©”íƒ€ë°ì´í„°ì¸ valid bit, dirty bit, tagì˜ ì •ë³´ë¥¼ ê³ ë ¤í•´ì•¼ í•¨
ì „ì²´ ë©”íƒ€ë°ì´í„° í¬ê¸°ëŠ” ê³§ ì „ì²´ ë©”íƒ€ë°ì´í„° ì˜¤ë²„í—¤ë“œë¥¼ ì˜ë¯¸
~~~
âœ… **ì „ì²´ block ìˆ˜:**
~~~
# of blocks = 2048 sets x 8 blocks/set = 2^14 blocks
~~~
âœ… **block ë‹¹ ë©”íƒ€ë°ì´í„°:**
~~~
Tag bits: ì• ë¬¸ì œì—ì„œ ê³„ì‚°í•œ ëŒ€ë¡œ 14 bits
Valid bit: 1 bit
Dirty bit: 1 bit

block ë‹¹ ë©”íƒ€ ë°ì´í„° ê°œìˆ˜ëŠ”,
14 + 1 + 1 = 16 bits = 2 bytes per block
~~~
ğŸ¯ **ì „ì²´ ë©”íƒ€ë°ì´í„° í¬ê¸°( = Metadata storage overhead):**
~~~
Metadata storage overhead = 2^14 blocks x 2 bytes = 2 ^ 15 bytes = 32 KiB
~~~

#### 3.3. â“Consider making the following changes to the cache. Which of the 3 types of cache misses (i.e., cold miss, capacity miss, and conflict miss) would be affected by the change and how would they change (i.e., increase or decrease)? Assume the capacity of the cache stays the same. The changes are not cumulative.
1) Block size is increased.
2) Set-associativity is decreased.
3) A prefetcher with a separate prefetch buffer is implemented. Requests to the cache can now â€œhitâ€ in the prefetch buffer. When a hit to the prefetch buffer occurs, the data is moved to the cache.

1ï¸âƒ£ 1ë²ˆ. Block sizeê°€ ì¦ê°€í•˜ë©´,
~~~
Cold Miss ê°ì†Œ:
    í•œë²ˆì— ë” ë§ì€ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ Spatial Localityê°€ ì¢‹ì€ ìƒí™©ì—ì„œ Cold Miss ê°ì†Œ
~~~

2ï¸âƒ£ 2ë²ˆ. Set-associativityê°€ ê°ì†Œí•˜ë©´,
~~~
Conflict Miss ì¦ê°€:
    ê° setì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” block ìˆ˜ê°€ ê°ì†Œí•˜ê³ ,
    ê°™ì€ indexë¡œ ë§¤í•‘ë˜ëŠ” ì£¼ì†Œë“¤ ê°„ì˜ ì¶©ëŒ(conflict) ì¦ê°€í•¨
~~~

3ï¸âƒ£ 3ë²ˆ. Prefetch ë²„í¼ë¥¼ ì‚¬ìš©í•˜ë©´,
~~~
Cold Miss ê°ì†Œ:
    í”„ë¡œê·¸ë¨ì—ì„œ ì•„ì§ ì ‘ê·¼í•˜ì§€ ì•Šì€ ë°ì´í„°ê°€ ë²„í¼ì— ë¯¸ë¦¬ ë¡œë“œë˜ë¯€ë¡œ 
    ì²« ì ‘ê·¼ ì‹œ missê°€ ë°œìƒí•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ

Capacity Miss ê°ì†Œ ê°€ëŠ¥:
    Prefetch bufferëŠ” cacheì— ìˆëŠ” ë°ì´í„°ë¥¼ ì«“ì•„ë‚´ì§€ ì•Šì•„ë„ ë°ì´í„° ìœ ì§€ ê°€ëŠ¥
~~~